# -*- coding: utf-8 -*-
import openpyxl
#from openpyxl import load_workbook
from console import Limpar_Tela

def abrirPlanilha(caminho):
    """
    Abre uma planilha do Excel e retorna o objeto da planilha.
    
    Parâmetros:
    caminho (str): Caminho completo para o arquivo da planilha.
    
    Retorna:
    openpyxl.workbook.workbook.Workbook: Objeto da planilha aberta.
    """
    Limpar_Tela()
    try:
        planilha = openpyxl.load_workbook(caminho)
        return planilha
    except FileNotFoundError:
        print(f"Arquivo não encontrado: {caminho}")
        return None
    except Exception as e:
        print(f"Erro ao abrir a planilha: {e}")
        return None
    
def salvarPlanilha(planilha, caminho):
    """
    Salva a planilha no caminho especificado.
    
    Parâmetros:
    planilha (openpyxl.workbook.workbook.Workbook): Objeto da planilha a ser salva.
    caminho (str): Caminho completo para salvar a planilha.
    
    Retorna:
    bool: True se a planilha foi salva com sucesso, False caso contrário.
    """
    Limpar_Tela()
    try:
        planilha.save(caminho)
        return True
    except Exception as e:
        print(f"Erro ao salvar a planilha: {e}")
        return False
    
def listar_conteudo(caminho):
    """
    Lista o conteúdo de um arquivo Excel (.xlsx).
    
    Parâmetros:
    caminho (str): Caminho completo para o arquivo Excel.
    
    Retorna:
    None
    """
    Limpar_Tela()
    # Usa a função abrirPlanilha para carregar o arquivo Excel
    planilha = abrirPlanilha(caminho)
    
    if planilha is None:
        return  # Se a planilha não foi carregada, encerra a função
    
    try:
        # Itera sobre todas as planilhas
        for sheet_name in planilha.sheetnames:
            print(f"Planilha: {sheet_name}")
            sheet = planilha[sheet_name]
            
            # Itera sobre as linhas e colunas da planilha
            for row in sheet.iter_rows(values_only=True):
                print(row)
            print("-" * 40)
    except Exception as e:
        print(f"Erro ao listar o conteúdo: {e}")
        return False
 